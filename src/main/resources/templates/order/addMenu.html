<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/">

<head>
    <meta charset="UTF-8">
    <title>菜單新增</title>
</head>

<body>
    <div th:replace="~{display/navbar}"></div>
    <!-- 主要內容區域 -->
    <div class="content">
        <div class="container mt-2">
            <h1 class="display-6">☕新增菜單☕</h1>
            <form id="menuForm" class="row g-3 mt-1">
                <div class="col-md-4">
                    <label for="foodName" class="form-label">餐點名稱</label>
                    <input type="text" class="form-control" id="foodName" name="foodName">
                </div>
                <div class="col-md-4">
                    <label for="foodPicture" class="form-label">圖片上傳</label>
                    <input type="file" class="form-control" id="foodPicture" name="foodPicture">
                </div>
                <div class="col-md-4">
                    <label for="foodPrice" class="form-label">價格</label>
                    <input type="text" class="form-control" id="foodPrice" name="foodPrice">
                </div>
                <div class="col-md-4">
                    <label for="foodKindId" class="form-label">餐點種類</label>
                    <select name="foodKindId" id="foodKindId" class="form-select" required>
                        <option value="" selected>請選擇種類</option>
                        <th:block th:each="foodKind : ${foodKinds}">
                            <option th:value="${foodKind.foodKindId}" th:text="${foodKind.foodKindName}"></option>
                        </th:block>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="foodStock" class="form-label">庫存</label>
                    <input type="text" class="form-control" id="foodStock" name="foodStock">
                </div>
                <div class="col-md-4">
                    <label for="foodStatus" class="form-label">餐點狀態</label>
                    <select class="form-select" id="foodStatus" name="foodStatus" aria-label="Default select example">
                        <option selected value="">請選擇</option>
                        <option value="1">正常供應</option>
                        <option value="2">停售</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="foodDescription" class="form-label">餐點描述</label>
                    <textarea class="form-control" id="foodDescription" name="foodDescription" rows="3"></textarea>
                </div>
                <div class="col-12 d-flex justify-content-center">
                    <button type="submit" id="addBtn " class="btn btn-primary" value="add">菜單提交</button>
                    <a href="http://localhost:8080/SpanTasty/order/menu" class="btn btn-secondary ms-2">返回全部</a>
                </div>
            </form>


        </div>
    </div>


    <script>

        document.addEventListener("DOMContentLoaded", function () {
            showSidebar('order');


            document.getElementById("menuForm").addEventListener("submit", function (event) {
                event.preventDefault();
                const submitter = document.querySelector("button[value=add]");
                const menuForm = document.getElementById("menuForm");
                const formDataObject = new FormData(menuForm, submitter);

                // 發送 POST 請求
                axios.post('http://localhost:8080/SpanTasty/order/menu', formDataObject)
                    .then(function (response) {
                        console.log(response.data);
                        alert("菜單已成功提交！");
                        //提交後回到getAllTogo
                        window.location.href = 'http://localhost:8080/SpanTasty/order/menu';
                    })
                    .catch(function (error) {
                        console.error("提交菜單時發生錯誤：", error);
                        alert("提交失敗，請稍後再試。");
                    })
            	})
        	})

    </script>

    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/js/jquery-3.7.1.min.js}"></script>
    <script th:src="@{/js/axios.min.js}"></script>
</body>

</html>